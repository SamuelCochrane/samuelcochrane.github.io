I"˜û<p>Question: Given the aroma/bitterness/etc of a cup of coffee, can we predict if it will be a ‚Äògood‚Äô cup of coffee as rated by professional coffee tasters?</p>

<p>Check out the <a href="https://github.com/SamuelCochrane/CoffeeML/blob/master/CoffeeML.ipynb">Jupyter Notebook</a> to follow along.</p>

<p>We‚Äôll bring in the data, do preliminary exploration, transform it for analysis, separate it into training/test sets, determine which model results in the highest accuracy predictions, and predict the rating a new cup of coffee might receive.</p>

<p>Info from <a href="https://coffeeinstitute.org">The Coffee Institute</a>, data scraped by <a href="https://github.com/jldbc/coffee-quality-database">James LeDoux</a>.</p>

<hr />

<p>Let‚Äôs start with our initial imports. This will bring in everything we‚Äôll need for the project, including ways to manipulate data (pandas), visualize data (matplotlib), and do ML analysis (sklearn)</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#importing
##data tools
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">pd</span><span class="p">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.max_columns'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="n">mcolors</span>
<span class="c1">##ML tools
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<p>Next let‚Äôs get the data and take a quick look at it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">coffeeRaw</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'arabica_data_cleaned.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coffeeRaw</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Species</th>
      <th>Owner</th>
      <th>Country.of.Origin</th>
      <th>Farm.Name</th>
      <th>Lot.Number</th>
      <th>Mill</th>
      <th>ICO.Number</th>
      <th>Company</th>
      <th>Altitude</th>
      <th>Region</th>
      <th>Producer</th>
      <th>Number.of.Bags</th>
      <th>Bag.Weight</th>
      <th>In.Country.Partner</th>
      <th>Harvest.Year</th>
      <th>Grading.Date</th>
      <th>Owner.1</th>
      <th>Variety</th>
      <th>Processing.Method</th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>Uniformity</th>
      <th>Clean.Cup</th>
      <th>Sweetness</th>
      <th>Cupper.Points</th>
      <th>Total.Cup.Points</th>
      <th>Moisture</th>
      <th>Category.One.Defects</th>
      <th>Quakers</th>
      <th>Color</th>
      <th>Category.Two.Defects</th>
      <th>Expiration</th>
      <th>Certification.Body</th>
      <th>Certification.Address</th>
      <th>Certification.Contact</th>
      <th>unit_of_measurement</th>
      <th>altitude_low_meters</th>
      <th>altitude_high_meters</th>
      <th>altitude_mean_meters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>METAD PLC</td>
      <td>300</td>
      <td>60 kg</td>
      <td>METAD Agricultural Development plc</td>
      <td>2014</td>
      <td>April 4th, 2015</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>Washed / Wet</td>
      <td>8.67</td>
      <td>8.83</td>
      <td>8.67</td>
      <td>8.75</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.75</td>
      <td>90.58</td>
      <td>0.12</td>
      <td>0</td>
      <td>0.0</td>
      <td>Green</td>
      <td>0</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>METAD PLC</td>
      <td>300</td>
      <td>60 kg</td>
      <td>METAD Agricultural Development plc</td>
      <td>2014</td>
      <td>April 4th, 2015</td>
      <td>metad plc</td>
      <td>Other</td>
      <td>Washed / Wet</td>
      <td>8.75</td>
      <td>8.67</td>
      <td>8.50</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.58</td>
      <td>89.92</td>
      <td>0.12</td>
      <td>0</td>
      <td>0.0</td>
      <td>Green</td>
      <td>1</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Arabica</td>
      <td>grounds for health admin</td>
      <td>Guatemala</td>
      <td>san marcos barrancas "san cristobal cuch</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1600 - 1800 m</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>1</td>
      <td>Specialty Coffee Association</td>
      <td>NaN</td>
      <td>May 31st, 2010</td>
      <td>Grounds for Health Admin</td>
      <td>Bourbon</td>
      <td>NaN</td>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>8.42</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>9.25</td>
      <td>89.75</td>
      <td>0.00</td>
      <td>0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>May 31st, 2011</td>
      <td>Specialty Coffee Association</td>
      <td>36d0d00a3724338ba7937c52a378d085f2172daa</td>
      <td>0878a7d4b9d35ddbf0fe2ce69a2062cceb45a660</td>
      <td>m</td>
      <td>1600.0</td>
      <td>1800.0</td>
      <td>1700.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Arabica</td>
      <td>yidnekachew dabessa</td>
      <td>Ethiopia</td>
      <td>yidnekachew dabessa coffee plantation</td>
      <td>NaN</td>
      <td>wolensu</td>
      <td>NaN</td>
      <td>yidnekachew debessa coffee plantation</td>
      <td>1800-2200</td>
      <td>oromia</td>
      <td>Yidnekachew Dabessa Coffee Plantation</td>
      <td>320</td>
      <td>60 kg</td>
      <td>METAD Agricultural Development plc</td>
      <td>2014</td>
      <td>March 26th, 2015</td>
      <td>Yidnekachew Dabessa</td>
      <td>NaN</td>
      <td>Natural / Dry</td>
      <td>8.17</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.67</td>
      <td>89.00</td>
      <td>0.11</td>
      <td>0</td>
      <td>0.0</td>
      <td>Green</td>
      <td>2</td>
      <td>March 25th, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1800.0</td>
      <td>2200.0</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Arabica</td>
      <td>metad plc</td>
      <td>Ethiopia</td>
      <td>metad plc</td>
      <td>NaN</td>
      <td>metad plc</td>
      <td>2014/2015</td>
      <td>metad agricultural developmet plc</td>
      <td>1950-2200</td>
      <td>guji-hambela</td>
      <td>METAD PLC</td>
      <td>300</td>
      <td>60 kg</td>
      <td>METAD Agricultural Development plc</td>
      <td>2014</td>
      <td>April 4th, 2015</td>
      <td>metad plc</td>
      <td>Other</td>
      <td>Washed / Wet</td>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.58</td>
      <td>88.83</td>
      <td>0.12</td>
      <td>0</td>
      <td>0.0</td>
      <td>Green</td>
      <td>2</td>
      <td>April 3rd, 2016</td>
      <td>METAD Agricultural Development plc</td>
      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>
      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>
      <td>m</td>
      <td>1950.0</td>
      <td>2200.0</td>
      <td>2075.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Ok. That‚Äôs a <em>lot</em> of info, far more than we need really.
Remember, our goal is to build something that can predict a value using only information we might have about a cup of coffee right in front of us. We won‚Äôt know the elevation, processing method, etc.
So let‚Äôs trim this down to a more useful dataset..</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coffee</span> <span class="o">=</span> <span class="n">coffeeRaw</span><span class="p">[[</span><span class="s">'Aroma'</span><span class="p">,</span><span class="s">'Flavor'</span><span class="p">,</span> <span class="s">'Aftertaste'</span><span class="p">,</span> <span class="s">'Acidity'</span><span class="p">,</span> <span class="s">'Body'</span><span class="p">,</span> <span class="s">'Balance'</span><span class="p">,</span>
                     <span class="s">'Total.Cup.Points'</span><span class="p">]].</span><span class="n">copy</span><span class="p">()</span>
<span class="n">coffee</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>Total.Cup.Points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.67</td>
      <td>8.83</td>
      <td>8.67</td>
      <td>8.75</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>90.58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.75</td>
      <td>8.67</td>
      <td>8.50</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>89.92</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>8.42</td>
      <td>89.75</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.17</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>89.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>88.83</td>
    </tr>
  </tbody>
</table>
</div>

<p>Much better.</p>

<p>Real quick, let‚Äôs make sure there‚Äôs no weirdness in our data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coffee</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">coffee</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1311 entries, 0 to 1310
Data columns (total 7 columns):
Aroma               1311 non-null float64
Flavor              1311 non-null float64
Aftertaste          1311 non-null float64
Acidity             1311 non-null float64
Body                1311 non-null float64
Balance             1311 non-null float64
Total.Cup.Points    1311 non-null float64
dtypes: float64(7)
memory usage: 71.8 KB





Aroma               0
Flavor              0
Aftertaste          0
Acidity             0
Body                0
Balance             0
Total.Cup.Points    0
dtype: int64
</code></pre></div></div>

<p>Yay, no blanks!</p>

<h1 id="pre-processing--basic-analysis">Pre-Processing &amp; Basic Analysis</h1>

<p>Since all we really want to algorithmically determine is if a certain cup is ‚Äògood‚Äô or ‚Äòbad‚Äô, let‚Äôs bin our data into those categories.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preprocessing into Good/Bad coffee
</span><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> <span class="c1">#anything scoring 85 or above is good coffee‚Ñ¢
</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'bad'</span><span class="p">,</span> <span class="s">'good'</span><span class="p">]</span>
<span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">coffee</span><span class="p">[</span><span class="s">'Total.Cup.Points'</span><span class="p">],</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">)</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">coffee</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Total.Cup.Points'</span><span class="p">])</span>
<span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">unique</span><span class="p">()</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[good, bad]
Categories (2, object): [bad &lt; good]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bad     1215
good      96
Name: goodCoffee, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#transform 'good' and 'bad' to 1 &amp; 0
</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">])</span>
<span class="n">coffee</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>goodCoffee</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.67</td>
      <td>8.83</td>
      <td>8.67</td>
      <td>8.75</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.75</td>
      <td>8.67</td>
      <td>8.50</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>8.42</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.17</td>
      <td>8.58</td>
      <td>8.42</td>
      <td>8.42</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.25</td>
      <td>8.50</td>
      <td>8.42</td>
      <td>8.33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>We can see we have way more bad coffee than good coffee. (Sad)
Let‚Äôs quickly graph this.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Plot the data
</span><span class="n">plt</span><span class="p">.</span><span class="n">xkcd</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">unique</span><span class="p">(),</span> <span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(),</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">'center'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mcolors</span><span class="p">.</span><span class="n">XKCD_COLORS</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s">'Good'</span><span class="p">,</span> <span class="s">'Not Good'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">())</span>

<span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">spines</span><span class="p">[</span><span class="s">'top'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">spines</span><span class="p">[</span><span class="s">'right'</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'# of entries'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'HOW MUCH OF THIS COFFEE SUCKS?'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://samuelcochrane.github.io/assets/images/output_10_0.png" alt="png1" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># and a pie chart
</span><span class="n">plt</span><span class="p">.</span><span class="n">xkcd</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">pie</span><span class="p">(</span><span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(),</span> <span class="n">explode</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">([</span><span class="s">'Not Good'</span><span class="p">,</span> <span class="s">'Good'</span><span class="p">]),</span> <span class="n">autopct</span><span class="o">=</span><span class="s">'%1.1f%%'</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">mcolors</span><span class="p">.</span><span class="n">XKCD_COLORS</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'HOW MUCH OF THIS COFFEE SUCKS?'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://samuelcochrane.github.io/assets/images/10302019.png" alt="png2" /></p>

<p>Finally, let‚Äôs finish getting our data ready for analysis by splitting it into training/test sets and standardizing the values to remove a bit of bias from the system.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#seperate feature/response vars
</span><span class="n">X</span> <span class="o">=</span> <span class="n">coffee</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">coffee</span><span class="p">[</span><span class="s">'goodCoffee'</span><span class="p">]</span>
<span class="c1">#train/test split
</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#standardize values
</span><span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="test-the-models">Test the models</h1>

<h2 id="random-forest-classifier">Random Forest Classifier</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#better for mid-size datasets
</span><span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">rfc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred_rfc</span> <span class="o">=</span> <span class="n">rfc</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#how well did model perform?
</span><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_rfc</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_rfc</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.98      0.98      0.98       244
           1       0.74      0.74      0.74        19

    accuracy                           0.96       263
   macro avg       0.86      0.86      0.86       263
weighted avg       0.96      0.96      0.96       263

[[239   5]
 [  5  14]]
</code></pre></div></div>

<h2 id="svm-classifier">SVM Classifier</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#better for smaller datasets
</span><span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="p">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred_clf</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#how well did model perform?
</span><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_clf</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_clf</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.98      0.98      0.98       244
           1       0.78      0.74      0.76        19

    accuracy                           0.97       263
   macro avg       0.88      0.86      0.87       263
weighted avg       0.97      0.97      0.97       263

[[240   4]
 [  5  14]]
</code></pre></div></div>

<h2 id="neural-network-multi-layer-percepitron-classifier">Neural Network (Multi-Layer Percepitron Classifier)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#better for huge amounts of data
</span><span class="n">mlpc</span><span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">mlpc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred_mlpc</span> <span class="o">=</span> <span class="n">mlpc</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_mlpc</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_mlpc</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.99      0.98      0.98       244
           1       0.76      0.84      0.80        19

    accuracy                           0.97       263
   macro avg       0.87      0.91      0.89       263
weighted avg       0.97      0.97      0.97       263

[[239   5]
 [  3  16]]
</code></pre></div></div>

<h2 id="whats-best">What‚Äôs best?</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="n">acc_rfc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_rfc</span><span class="p">)</span>
<span class="n">acc_clf</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_clf</span><span class="p">)</span>
<span class="n">acc_mlpc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_mlpc</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Random Forest was </span><span class="si">{</span><span class="n">acc_rfc</span><span class="p">:.</span><span class="mi">2</span><span class="o">%</span><span class="si">}</span><span class="s"> accurate"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"SVM was </span><span class="si">{</span><span class="n">acc_clf</span><span class="p">:.</span><span class="mi">2</span><span class="o">%</span><span class="si">}</span><span class="s"> accurate"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Neural Network was </span><span class="si">{</span><span class="n">acc_mlpc</span><span class="p">:.</span><span class="mi">2</span><span class="o">%</span><span class="si">}</span><span class="s"> accurate"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Random Forest was 96.20% accurate
SVM was 96.58% accurate
Neural Network was 96.96% accurate
</code></pre></div></div>

<p>All our models preformed about the same, with the neural net just a little bit better than everyone else.
We‚Äôll implement that model. This is doubley nice because now we get to say ‚ÄúI implemented a neural network‚Äù which sounds very fancy indeed.</p>

<h1 id="predicting-future-values">Predicting future values</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#a reminder what our data looks like
</span><span class="n">coffee</span><span class="p">[</span><span class="mi">90</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Aroma</th>
      <th>Flavor</th>
      <th>Aftertaste</th>
      <th>Acidity</th>
      <th>Body</th>
      <th>Balance</th>
      <th>goodCoffee</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>90</th>
      <td>8.42</td>
      <td>8.00</td>
      <td>7.42</td>
      <td>8.00</td>
      <td>7.92</td>
      <td>7.92</td>
      <td>1</td>
    </tr>
    <tr>
      <th>91</th>
      <td>7.58</td>
      <td>7.83</td>
      <td>7.83</td>
      <td>7.92</td>
      <td>7.83</td>
      <td>8.17</td>
      <td>1</td>
    </tr>
    <tr>
      <th>92</th>
      <td>7.83</td>
      <td>8.00</td>
      <td>7.75</td>
      <td>7.75</td>
      <td>7.83</td>
      <td>7.83</td>
      <td>1</td>
    </tr>
    <tr>
      <th>93</th>
      <td>8.08</td>
      <td>8.17</td>
      <td>7.92</td>
      <td>8.00</td>
      <td>8.08</td>
      <td>8.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>94</th>
      <td>7.67</td>
      <td>8.00</td>
      <td>7.83</td>
      <td>8.00</td>
      <td>7.92</td>
      <td>7.83</td>
      <td>1</td>
    </tr>
    <tr>
      <th>95</th>
      <td>7.50</td>
      <td>7.92</td>
      <td>8.25</td>
      <td>7.83</td>
      <td>7.92</td>
      <td>7.75</td>
      <td>1</td>
    </tr>
    <tr>
      <th>96</th>
      <td>8.17</td>
      <td>7.92</td>
      <td>7.75</td>
      <td>7.75</td>
      <td>7.67</td>
      <td>7.75</td>
      <td>0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>8.00</td>
      <td>7.92</td>
      <td>7.75</td>
      <td>7.92</td>
      <td>7.75</td>
      <td>7.83</td>
      <td>0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>7.83</td>
      <td>8.00</td>
      <td>7.58</td>
      <td>7.92</td>
      <td>7.92</td>
      <td>7.83</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99</th>
      <td>7.83</td>
      <td>8.00</td>
      <td>7.83</td>
      <td>7.75</td>
      <td>7.67</td>
      <td>7.83</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#---------------
#A theoretical cup of coffee
</span><span class="n">new_Aroma</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">new_Flavor</span> <span class="o">=</span> <span class="mf">7.5</span>
<span class="n">new_Aftertaste</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">new_Acidity</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">new_Body</span> <span class="o">=</span> <span class="mf">7.9</span>
<span class="n">new_Balance</span> <span class="o">=</span> <span class="mi">8</span>
<span class="c1">#---------------
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_new</span> <span class="o">=</span> <span class="p">[[</span><span class="n">new_Aroma</span><span class="p">,</span> <span class="n">new_Flavor</span><span class="p">,</span> <span class="n">new_Aftertaste</span><span class="p">,</span> <span class="n">new_Acidity</span><span class="p">,</span> <span class="n">new_Body</span><span class="p">,</span> <span class="n">new_Balance</span><span class="p">]]</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">sc</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="n">y_new</span> <span class="o">=</span> <span class="n">mlpc</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_new</span><span class="p">)</span>
<span class="k">if</span> <span class="n">y_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"it's good!"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="p">(</span><span class="s">"it's not good!"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1]
it's good!
</code></pre></div></div>
:ET